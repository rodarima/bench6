# miniAMR - Adaptive Mesh Refinement Mini-App

miniAMR applies a stencil calculation on a unit cube computational domain, which is divided into blocks. The blocks all have the same number of cells in each direction and communicate ghost values with neighboring blocks. With adaptive mesh refinement, the blocks can represent different levels of refinement in the larger mesh. Neighboring blocks can be at the same level or one level different, which means that the length of cells in neighboring blocks can differ by only a factor of two in each direction. The calculations on the variables in each cell is an averaging of the values in the chosen stencil. The refinement and coarsening of the blocks is driven by objects that are pushed through the mesh. If a block intersects with the surface or the volume of an object, then that block can be refined. There is also an option to uniformly refine the mesh. Each cell contains a number of variables, each of which is evaluated indepently.

Questions? Contact Courtenay Vaughan (ctvaugh@sandia.gov)

This mini-application has several variants. All variants have some fixes and optimizations that were not present in the [original](https://github.com/Mantevo/miniAMR) version. Some of them are that 3-D data blocks are consecutive in memory and the 7-point stencil function copies consecutive block data with `memcpy`.

The variants are:

  * **mpi**: The reference variant parallelized with pure MPI. This version is licensed under the terms contained in the `LICENSE` file.
  * **mpi+omp**: An hybrid variant parallelized with MPI and OpenMP worksharing constructs. This version is licensed under the terms contained in the `LICENSE` file.
  * **mpi+omp+tampi**: An **experimental** and **incomplete** hybrid variant parallelized with MPI, OpenMP task constructs and the [Task-Aware MPI (TAMPI)](https://github.com/bsc-pm/tampi) library. This version is licensed under the terms contained in the `LICENSE` and `mpi+omp+tampi/LICENSE` files.
  * **mpi+oss+tampi**: An hybrid variant parallelized with MPI, OmpSs-2 tasks and the [Task-Aware MPI (TAMPI)](https://github.com/bsc-pm/tampi) library. This version has a complete taskification of the non-refinement parts of the application and uses the asynchronous services of TAMPI for communication tasks. The refinement and load-balancing stages are not fully taskified; they only taskify the intra- and inter-process movement of block data. More information about this variant is available in this [article](https://doi.org/10.1109/CLUSTER49012.2020.00042). This version is licensed under the terms contained in the `LICENSE` and `mpi+oss+tampi/LICENSE` files.
  * **gaspi+oss+tagaspi**: An hybrid variant parallelized with one-sided GASPI, OmpSs-2 tasks and the [Task-Aware GASPI (GASPI)](https://github.com/bsc-pm/tagaspi) library. This version has a complete taskification of the non-refinement parts of the application and uses the asynchronous services of TAGASPI for communication tasks. The refinement and load-balancing stages are not fully taskified; they only taskify the intra- and inter-process movement of block data. For simplicity, this version leverages TAMPI during the load-balancing stages to exchange block data among processes. More information about this variant is available in this [article](https://doi.org/10.1109/Cluster48925.2021.00024). This version is licensed under the terms contained in the `LICENSE` and `gaspi+oss+tagaspi/LICENSE` files.

As stated previously, the taskified variants (``mpi+omp+tampi``, ``mpi+oss+tampi`` and ``gaspi+oss+tagaspi``) are also licensed under the terms contained in their own LICENSE file, located inside their corresponding subfolders. These licenses apply to the code parts that have been modified in order to taskify the application.
